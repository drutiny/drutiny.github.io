{"title":"#2819197 - Cloudflare workaround for Drupal 8 urlGenerator","class":"\\Drutiny\\Cloudflare\\Audit\\PageRuleAnalysis","name":"cloudflare:drupal-urlGenerator-workaround","description":"By accessing a site an an unexpected base path (e.g. with index.php) a site may\ncache links in a way that could be considered a minor site defacement and\npossibly lead to a duplicate content SEO penalty too. It can also impact\ncaching strategy.\n","remediation":"{{^settings.forwarding_url}}\n1. Add a page rule in Cloudflare with the matching pattern of `https:\/\/{{host}}\/index.php\/*`.\n{{\/settings.forwarding_url}}\n\nFor this rule, ensure a Forwarding URL setting is selected and forwards to\n`https:\/\/{{host}}\/$1` with a status code of `301`\n","success":"There is a page rule for {{rule}} which forwards to {{settings.forwarding_url.url}}\nwith a status code of {{settings.forwarding_url.status_code}}.\n","failure":"{{#settings.forwarding_url}}\nA forwarding URL was found forwarding to **{{settings.forwarding_url.url}}**\nwith a status code of **{{settings.forwarding_url.status_code}}**. Was expecting\na redirect to **https:\/\/{{host}}\/$1** with a status code of **301**.\n{{\/settings.forwarding_url}}\n\n{{^settings.forwarding_url}}\nNo redirect was found. Was expecting a redirect to **https:\/\/{{host}}\/$1**\nwith a status code of **301**.\n{{\/settings.forwarding_url}}\n","parameters":{"rule":{"default":"https:\/\/:host\/index.php\/*"},"expression":{"default":"array_key_exists('forwarding_url', settings) and (settings['forwarding_url']['status_code'] == 301)"}},"language":"en","type":"audit","signature":"bbba613578846f79ad755a772eb82051187783ea"}