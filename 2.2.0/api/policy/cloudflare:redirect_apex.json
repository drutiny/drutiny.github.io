{"title":"Cloudflare redirect Apex to primary domain","name":"cloudflare:redirect_apex","class":"\\Drutiny\\Cloudflare\\Audit\\PageRuleMatch","description":"If {{host}} is the primary site under the {{zone}} domain then you may want all\ntraffic to https:\/\/{{zone}}\/ to be redirected to https:\/\/{{host}}\/. This ensures\nall traffic to both {{host}} and {{zone}} are routed through a common domain\nand makes management of Cloudflare Page Rules easier to administer. This reduces\nthe likelihood of strange behaviour due to Page Rules.\n","type":"audit","success":"There is a page rule for {{rule}} which forwards to {{settings.forwarding_url.url}}\nwith a status code of {{settings.forwarding_url.status_code}}.\n","failure":"{{#actions.forwarding_url}}\n  A Forwarding URL was found but incorrect. URL forwarded to\n  {{actions.forwarding_url.url}} with a status code of\n  {{actions.forwarding_url.status_code}}.\n{{\/actions.forwarding_url}}\n{{^actions.forwarding_url}}\n  No such rule was found with an existing Forwarding URL.\n{{\/actions.forwarding_url}}\n","remediation":"Add a page rule in Cloudflare with the matching pattern of `{{rule}}`.\n\nFor this rule, ensure a Forwarding URL setting is selected and forwards to\n`{{settings.forwarding_url.url}}` with a status code of *{{settings.forwarding_url.status_code}}*\n","severity":2,"signature":"ca93f11618fdf2c8ce20a211dd3997a519bb9273"}